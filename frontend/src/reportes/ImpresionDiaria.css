.rpt-wrap{font-family:Arial,Helvetica,sans-serif;color:#000;-webkit-print-color-adjust:exact;print-color-adjust:exact}
.rpt-header{margin-bottom:12px}
.rpt-line{ text-align:center; padding:6px 8px; font-size:12px; line-height:1.2; border-left:1px solid #000; border-right:1px solid #000;}
.rpt-line1{ font-weight:bold; background:#e9e9e9; border-top:3px solid #000; }
.rpt-line2{ background:#f3f3f3; }
.rpt-line3{ background:#fff; font-weight:bold; font-size:14px; border-bottom:1px solid #000; }
.rpt-fecha{ text-align:right; margin-top:6px; font-size:12px; }

.rpt-table{ width:100%; border-collapse:collapse; table-layout:fixed; border:1px solid #000; font-size:12px; }
.rpt-table thead th, .rpt-table tbody td, .rpt-table tfoot td{ border:1px solid #000; padding:6px; vertical-align:middle; }
.rpt-table thead th{ text-align:center; font-weight:bold; }
.rpt-table .sub{ font-size:11px; margin-top:2px; }
.area-col{ width:32%; }
.num{ text-align:right; }
.resp{ width:16%; }
.firma{ width:12%; }

@media print { .rpt-table thead{display:table-header-group} .rpt-table tfoot{display:table-footer-group} }
@page { size:A4 portrait; margin:12mm; }

.rpt-firma-block{ margin:40px auto 0; width:60%; text-align:center; }
.rpt-firma-line{ border-bottom:1px solid #000; margin:0 auto 6px; width:80%; height:20px; }
.rpt-firma-nombre{ font-weight:bold; }
.rpt-firma-cargo{ font-size:12px; }

/* Evitar desbordes en encabezados de columnas */
.rpt-table { table-layout: fixed; border-collapse: collapse; }
.rpt-table th { white-space: normal; word-break: break-word; hyphens: auto; }
.rpt-table th .title { line-height: 1.15; font-size: 12px; } /* título un poquito más pequeño */


/* ====== Base (tu mismo estilo) ====== */
.rpt-wrap{font-family:Arial,Helvetica,sans-serif;color:#000;-webkit-print-color-adjust:exact;print-color-adjust:exact}
.rpt-header{margin-bottom:12px}
.rpt-line{ text-align:center; padding:6px 8px; font-size:12px; line-height:1.2; border-left:1px solid #000; border-right:1px solid #000;}
.rpt-line1{ font-weight:bold; background:#e9e9e9; border-top:3px solid #000; }
.rpt-line2{ background:#f3f3f3; }
.rpt-line3{ background:#fff; font-weight:bold; font-size:14px; border-bottom:1px solid #000; }
.rpt-fecha{ text-align:right; margin-top:6px; font-size:12px; }

.rpt-table{ width:100%; border-collapse:collapse; table-layout:fixed; border:1px solid #000; font-size:12px; }
.rpt-table thead th, .rpt-table tbody td, .rpt-table tfoot td{ border:1px solid #000; padding:6px; vertical-align:middle; }
.rpt-table thead th{ text-align:center; font-weight:bold; }
.rpt-table .sub{ font-size:11px; margin-top:2px; }
.area-col{ width:32%; }
.num{ text-align:right; }
.resp{ width:16%; }
.firma{ width:12%; }
.rpt-table th { white-space: normal; word-break: break-word; hyphens: auto; }
.rpt-table th .title { line-height: 1.15; font-size: 12px; }

/* Mantener encabezado/pie en cada hoja impresa */
@media print { 
  .rpt-table thead{display:table-header-group} 
  .rpt-table tfoot{display:table-footer-group} 
  .rpt-table tr{ page-break-inside: avoid; }
}

/* ====== Tamaño físico de la hoja ======
   A4: 210x297mm. Con márgenes de 12mm por lado:
   ancho útil = 186mm, alto útil ~ 273mm.
   (Si usas Carta/Letter, ver nota más abajo) */
@page { size: A4 portrait; margin:12mm; }

.rpt-wrap {
  width: 186mm;            /* 210 - 12 - 12 */
  min-height: 273mm;       /* 297 - 12 - 12 */
  background:#fff;
  border: 0.75pt solid #000;
}

/* ====== Vista en pantalla (preview en modal) ====== */
@media screen {
  .rpt-preview { max-height: 70vh; overflow:auto; }
  .rpt-wrap {
    transform: scale(.60);           /* se ve completa sin tocar el zoom */
    transform-origin: top left;
    box-shadow: 0 6px 24px rgba(0,0,0,.14);
    margin-bottom: 8px;
  }
}

/* ====== Al imprimir ====== */
@media print {
  html, body { background:#fff; margin:0 !important; }

  /* Ocultar todo excepto el reporte */
  body * { visibility: hidden; }
  .rpt-print-root, .rpt-print-root * { visibility: visible; }
  .rpt-print-root { position: static !important; inset: auto !important; }

  /* Quitar el scale del preview para imprimir 100% */
  .rpt-wrap { transform: none !important; box-shadow: none !important; border: 1pt solid #000; }
}
